<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò—Å—Ç–æ—Ä–∏—è –°–∞—à–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            width: 100%;
            max-width: 900px;
            background: white;
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
            position: relative;
            min-height: 600px;
        }

        .game-header {
            background: linear-gradient(90deg, #667eea, #764ba2);
            padding: 20px;
            color: white;
            text-align: center;
            font-weight: bold;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            min-height: 80px;
        }

        .back-to-menu-btn {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.9);
            border: 2px solid white;
            color: #667eea;
            padding: 8px 16px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .back-to-menu-btn:hover {
            background: white;
            transform: translateY(-50%) scale(1.05);
        }

        .game-content {
            position: relative;
            height: 500px;
            overflow: hidden;
        }

        .background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0.3;
            z-index: 1;
        }

        .characters {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60%;
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
            padding: 20px;
            z-index: 2;
        }

        .character {
            width: 120px;
            height: 200px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: bottom center;
            transition: transform 0.3s ease;
        }

        .character:hover {
            transform: scale(1.1);
        }

        .dialogue-container {
            position: relative;
            z-index: 3;
            padding: 20px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
        }

        .dialogue-box {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 2px solid #e0e0e0;
            max-width: 100%;
        }

        .character-name {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .dialogue-text {
            font-size: 16px;
            line-height: 1.5;
            color: #333;
        }

        .thoughts {
            font-style: italic;
            color: #666;
        }

        .choices-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 3;
            padding: 20px;
        }

        .choice-btn {
            background: transparent;
            color: #333;
            border: 2px solid #667eea;
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            font-weight: 500;
        }

        .choice-btn:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .result-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 2px solid #e0e0e0;
            z-index: 3;
        }

        .lives {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #ff6b6b;
            color: white;
            padding: 5px 10px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 14px;
        }

        .hidden {
            display: none !important;
        }

        .screen {
            height: 500px;
            display: flex;
            flex-direction: column;
        }

        .menu-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px;
            text-align: center;
        }

        .menu-title {
            font-size: 32px;
            margin-bottom: 20px;
            color: #333;
        }

        .menu-subtitle {
            font-size: 16px;
            line-height: 1.6;
            color: #555;
            margin-bottom: 30px;
            max-width: 600px;
        }

        .menu-btn {
            background: linear-gradient(90deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-size: 18px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            font-weight: 600;
            min-width: 200px;
        }

        .menu-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .menu-btn.secondary {
            background: transparent;
            border: 2px solid #667eea;
            color: #667eea;
        }

        .help-text {
            text-align: left;
            line-height: 1.6;
            color: #333;
            max-width: 600px;
            margin: 0 auto;
            font-size: 14px;
            padding: 20px;
        }

        .help-text h3 {
            color: #667eea;
            margin: 20px 0 10px 0;
            font-size: 18px;
        }

        .navigation-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            padding: 20px;
            background: rgba(255,255,255,0.9);
        }

        .nav-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .nav-btn:hover:not(:disabled) {
            transform: translateY(-2px);
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .stage-info {
            font-size: 14px;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω -->
        <div id="start-screen" class="screen">
            <div class="menu-container">
                <h1 class="menu-title">–ò—Å—Ç–æ—Ä–∏—è –°–∞—à–∏</h1>
                <p class="menu-subtitle">
                    –ü—Ä–∏–≤–µ—Ç! –°–µ–≥–æ–¥–Ω—è —Ç–≤–æ–π –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è, –∏ —è –±—ã –æ—á–µ–Ω—å —Ö–æ—Ç–µ–ª–∞ –ø—Ä–æ–≤–µ—Å—Ç–∏ –µ–≥–æ —Å —Ç–æ–±–æ–π. –•–æ—Ç—å —Å–µ–π—á–∞—Å –º—ã –Ω–µ —Ä—è–¥–æ–º, —è –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–ª–∞ –¥–ª—è —Ç–µ–±—è –ø–æ–¥–∞—Ä–æ–∫, –∫–æ—Ç–æ—Ä—ã–π —Ç–µ–±–µ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç –Ω–∞–π—Ç–∏. 
                    –ü–µ—Ä–µ–¥ —Ç–æ–±–æ–π –∏–≥—Ä–∞, –≥–¥–µ —Ç—ã —Å—ã–≥—Ä–∞–µ—à—å –∑–∞ —Å–≤–æ–µ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äì –ø—Ä–æ–π—Ç–∏ –ø—É—Ç—å –¥–æ 24-–ª–µ—Ç–∏—è, –¥–µ–ª–∞—è –Ω–∞ —Å–≤–æ–µ–º –∂–∏–∑–Ω–µ–Ω–Ω–æ–º –ø—É—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤—ã–±–æ—Ä—ã. –£ —Ç–µ–±—è –µ—Å—Ç—å 3 –∂–∏–∑–Ω–∏: –µ—Å–ª–∏ —Ç—ã –∏—Ö –ø–æ—Ç–µ—Ä—è–µ—à—å, —Ç–æ –∏–≥—Ä–∞ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è, –∏ –ø—Ä–∏–¥–µ—Ç—Å—è –Ω–∞—á–∞—Ç—å –≤—Å–µ —Å–Ω–∞—á–∞–ª–∞. –í –∫–æ–Ω—Ü–µ —Ç—ã —É–≤–∏–¥–∏—à—å —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥: –æ—Ç–ø—Ä–∞–≤—å –µ–≥–æ –º–Ω–µ, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å, –∫–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Å–≤–æ–π –ø–æ–¥–∞—Ä–æ–∫. –£–¥–∞—á–∏! ‚ù§Ô∏è‚Äçüî•
                </p>
                <button class="menu-btn" onclick="startNewGame()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                <button class="menu-btn secondary" onclick="continueGame()" id="continue-btn">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
                <button class="menu-btn secondary" onclick="showHelp()">–ü–æ–º–æ—â—å</button>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –ø–æ–º–æ—â–∏ -->
        <div id="help-screen" class="screen hidden">
            <div class="game-header">
                <button class="back-to-menu-btn" onclick="showStart()">‚Üê –ú–µ–Ω—é</button>
                <span>–ü–æ–º–æ—â—å</span>
            </div>
            <div class="menu-container">
                <div class="help-text">
                    <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é "–ò—Å—Ç–æ—Ä–∏—è –°–∞—à–∏"!</p>
                    <h3>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</h3>
                    <p>‚Ä¢ –ß–∏—Ç–∞–π—Ç–µ –¥–∏–∞–ª–æ–≥–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∏ —Å–ª–µ–¥–∏—Ç–µ –∑–∞ —Å—é–∂–µ—Ç–æ–º</p>
                    <p>‚Ä¢ –í –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –≤–∞–º –±—É–¥—É—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω—ã –≤—ã–±–æ—Ä—ã</p>
                    <p>‚Ä¢ –í–∞—à–∏ —Ä–µ—à–µ–Ω–∏—è –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏</p>
                    <p>‚Ä¢ –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –≤—ã–±–æ—Ä—ã –º–æ–≥—É—Ç —Å—Ç–æ–∏—Ç—å –≤–∞–º –∂–∏–∑–Ω–µ–π (—É –≤–∞—Å –µ—Å—Ç—å 3 –∂–∏–∑–Ω–∏)</p>
                    <h3>–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:</h3>
                    <p>‚Ä¢ –í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ</p>
                    <p>‚Ä¢ –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–∫—Ä—ã—Ç—å –∏–≥—Ä—É –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å —Ç–æ–≥–æ –∂–µ –º–µ—Å—Ç–∞</p>
                    <p>‚Ä¢ –î–ª—è —Å–±—Ä–æ—Å–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –Ω–∞–∂–º–∏—Ç–µ "–ù–æ–≤–∞—è –∏–≥—Ä–∞"</p>
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</h3>
                    <p>‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ "–î–∞–ª–µ–µ ‚Üí" –∏ "‚Üê –ù–∞–∑–∞–¥" –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ –¥–∏–∞–ª–æ–≥–∞–º</p>
                    <p>‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π</p>
                    <p>‚Ä¢ –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–∞—Å –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</p>
                    <h3>–°–æ–≤–µ—Ç—ã:</h3>
                    <p>‚Ä¢ –î—É–º–∞–π—Ç–µ –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è</p>
                    <p>‚Ä¢ –ü–æ—Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –∂–∏–∑–Ω–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ª—É—á—à–µ–≥–æ –∫–æ–Ω—Ü–∞</p>
                    <p>‚Ä¢ –í –∫–æ–Ω—Ü–µ –∏–≥—Ä—ã –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–∞—Ä–∫–∞!</p>
                </div>
            </div>
        </div>

        <!-- –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω -->
        <div id="game-screen" class="screen hidden">
            <div class="game-header">
                <button class="back-to-menu-btn" onclick="saveAndReturnToMenu()">‚Üê –ú–µ–Ω—é</button>
                <span class="stage-info" id="stage-info">–≠—Ç–∞–ø ‚Ññ1 | –í–æ–∑—Ä–∞—Å—Ç: 7 –ª–µ—Ç | –ú—É—Ä–º–∞–Ω—Å–∫</span>
                <div class="lives">–ñ–∏–∑–Ω–∏: <span id="lives-count">3</span></div>
            </div>
            <div class="game-content">
                <!-- –§–û–ù –ú–£–†–ú–ê–ù–°–ö - –í–ê–®–ï –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ï -->
                <div class="background" id="background" style="background-image: url('https://github.com/Psina1/Psina1.github.io/raw/main/images/Murmansk-7-let.png?raw=true');"></div>
                
                <div class="characters">
                    <!-- –ú–ï–°–¢–û –î–õ–Ø –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø –°–ê–®–ò - –ó–ê–ú–ï–ù–ò–¢–ï URL –ö–û–ì–î–ê –ó–ê–ì–†–£–ó–ò–¢–ï -->
                    <div class="character" id="sasha" style="background-image: url('https://github.com/Psina1/Psina1.github.io/raw/main/images/sasha.png?raw=true');"></div>
                    
                    <!-- –ú–ï–°–¢–û –î–õ–Ø –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø –ú–ê–ú–´ - –ó–ê–ú–ï–ù–ò–¢–ï URL –ö–û–ì–î–ê –ó–ê–ì–†–£–ó–ò–¢–ï -->
                    <div class="character" id="mama" style="background-image: url('https://github.com/Psina1/Psina1.github.io/raw/main/images/mama.png?raw=true');"></div>
                    
                    <!-- –ú–ï–°–¢–û –î–õ–Ø –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø –î–ò–ú–´ - –ó–ê–ú–ï–ù–ò–¢–ï URL –ö–û–ì–î–ê –ó–ê–ì–†–£–ó–ò–¢–ï -->
                    <div class="character" id="dima" style="background-image: url('https://github.com/Psina1/Psina1.github.io/raw/main/images/dima.png?raw=true');"></div>
                </div>
                
                <div class="dialogue-container" id="dialogue-container">
                    <!-- –î–∏–∞–ª–æ–≥–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
                </div>
            </div>
            
            <div class="choices-container hidden" id="choices-container">
                <!-- –í—ã–±–æ—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <div class="result-container hidden" id="result-container">
                <div id="result-text"></div>
            </div>
            
            <div class="navigation-container" id="nav-container">
                <button class="nav-btn" id="prev-btn" onclick="showPreviousDialogue()" disabled>‚Üê –ù–∞–∑–∞–¥</button>
                <button class="nav-btn" id="next-btn" onclick="showNextDialogue()">–î–∞–ª–µ–µ ‚Üí</button>
            </div>
        </div>
    </div>

    <script>
        // –°–∏—Å—Ç–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        const SAVE_KEY = 'sasha_story_save';
        
        // –ò–≥—Ä–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        const gameData = {
            currentStage: 1,
            currentDialogueIndex: 0,
            lives: 3,
            completedStages: [],
            choices: {}
        };

        // –î–∏–∞–ª–æ–≥–∏ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —ç—Ç–∞–ø–∞
        const stages = {
            1: {
                title: "–≠—Ç–∞–ø ‚Ññ1 | –í–æ–∑—Ä–∞—Å—Ç: 7 –ª–µ—Ç | –ú—É—Ä–º–∞–Ω—Å–∫",
                background: "https://github.com/Psina1/Psina1.github.io/raw/main/images/Murmansk-7-let.png?raw=true",
                dialogues: [
                    { character: "–ú–∞–º–∞", text: "¬´–°–∞—à–∞, –º–Ω–µ –Ω—É–∂–Ω–æ —Å—Ö–æ–¥–∏—Ç—å –≤ –ø–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—Å–∫—É—é. –ë—É–¥—å –¥–æ–±—Ä, –ø—Ä–∏—Å–º–æ—Ç—Ä–∏ –∑–∞ –î–∏–º–æ–π. –û–Ω –º–∞–ª–µ–Ω—å–∫–∏–π, –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å¬ª" },
                    { character: "–°–∞—à–∞", text: "¬´–ú–∞–∞–º, –Ω—É —è –∂–µ —Ö–æ—á—É —Å —Ä–µ–±—è—Ç–∞–º–∏ –≤ —Ñ—É—Ç–±–æ–ª –ø–æ–∏–≥—Ä–∞—Ç—å‚Ä¶¬ª" },
                    { character: "–î–∏–º–∞ (—Ç—è–Ω–µ—Ç –∑–∞ —Ä—É–∫—É)", text: "¬´–°–∞—à, –ø–æ—à–ª–∏ –≥—É–ª—è—Ç—å! –ù–∞ —É–ª–∏—Ü–µ —Ç–∞–∫ —Ç–µ–ø–ª–æ!¬ª" },
                    { character: "–ú–∞–º–∞ (—Å—Ç—Ä–æ–≥–æ)", text: "¬´–¢—ã —Å—Ç–∞—Ä—à–∏–π –±—Ä–∞—Ç. –ù–∞ —Ç–µ–±–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å.¬ª" },
                    { character: "–°–∞—à–∞ (–¥—É–º–∞–µ—Ç)", text: "¬´–≠—Ö, –∫–∞–∫ –∂–µ –±—ã—Ç—å?..¬ª", isThought: true }
                ],
                choices: [
                    { text: "–ü—Ä–∏—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞ –î–∏–º–æ–π –∏ –ø–æ–π—Ç–∏ —Å –Ω–∏–º –≥—É–ª—è—Ç—å", type: "good" },
                    { text: "–£–±–µ–∂–∞—Ç—å –∫ –¥—Ä—É–∑—å—è–º –∏ –æ—Å—Ç–∞–≤–∏—Ç—å –î–∏–º—É", type: "bad" }
                ]
            }
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
        function loadSave() {
            const save = localStorage.getItem(SAVE_KEY);
            if (save) {
                const parsed = JSON.parse(save);
                Object.assign(gameData, parsed);
                return true;
            }
            return false;
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–≥—Ä—ã
        function saveGame() {
            localStorage.setItem(SAVE_KEY, JSON.stringify(gameData));
        }

        // –ü–æ–∫–∞–∑ —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
        function showStart() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
            const hasSave = loadSave();
            const continueBtn = document.getElementById('continue-btn');
            
            if (hasSave && gameData.currentDialogueIndex > 0) {
                continueBtn.style.display = 'block';
                continueBtn.textContent = `–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å (–≠—Ç–∞–ø ${gameData.currentStage})`;
            } else {
                continueBtn.style.display = 'none';
            }
            
            showScreen('start-screen');
        }

        function showHelp() {
            showScreen('help-screen');
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
        }

        // –ù–æ–≤–∞—è –∏–≥—Ä–∞
        function startNewGame() {
            // –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö
            Object.assign(gameData, {
                currentStage: 1,
                currentDialogueIndex: 0,
                lives: 3,
                completedStages: [],
                choices: {}
            });
            
            localStorage.removeItem(SAVE_KEY);
            startGame();
        }

        // –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–≥—Ä—É
        function continueGame() {
            loadSave();
            startGame();
        }

        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é
        function saveAndReturnToMenu() {
            saveGame();
            showStart();
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        function startGame() {
            showScreen('game-screen');
            
            const stage = stages[gameData.currentStage];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            document.getElementById('stage-info').textContent = stage.title;
            document.getElementById('background').style.backgroundImage = `url('${stage.background}')`;
            document.getElementById('lives-count').textContent = gameData.lives;
            document.getElementById('dialogue-container').innerHTML = '';
            document.getElementById('choices-container').classList.add('hidden');
            document.getElementById('result-container').classList.add('hidden');
            document.getElementById('prev-btn').disabled = true;
            document.getElementById('next-btn').disabled = false;
            document.getElementById('next-btn').textContent = '–î–∞–ª–µ–µ ‚Üí';
            document.getElementById('next-btn').onclick = showNextDialogue;
            
            // –ï—Å–ª–∏ —ç—Ç–æ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å –º–µ—Å—Ç–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
            if (gameData.currentDialogueIndex > 0) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏
                for (let i = 0; i < gameData.currentDialogueIndex; i++) {
                    showDialogue(stage.dialogues[i], false);
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å –ª–∏ –¥–∏–∞–ª–æ–≥–∏
                if (gameData.currentDialogueIndex >= stage.dialogues.length) {
                    showChoices();
                }
            } else {
                // –ù–æ–≤—ã–π —ç—Ç–∞–ø - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–π –¥–∏–∞–ª–æ–≥
                showNextDialogue();
            }
        }

        function showDialogue(dialogue, animate = true) {
            const dialogueBox = document.createElement('div');
            dialogueBox.className = 'dialogue-box';
            if (animate) {
                dialogueBox.style.opacity = '0';
                dialogueBox.style.transform = 'translateY(20px)';
            }
            
            dialogueBox.innerHTML = `
                <div class="character-name ${dialogue.isThought ? 'thoughts' : ''}">${dialogue.character}${dialogue.isThought ? ' (–¥—É–º–∞–µ—Ç):' : ':'}</div>
                <div class="dialogue-text">${dialogue.text}</div>
            `;
            
            document.getElementById('dialogue-container').appendChild(dialogueBox);
            
            if (animate) {
                setTimeout(() => {
                    dialogueBox.style.opacity = '1';
                    dialogueBox.style.transform = 'translateY(0)';
                    dialogueBox.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                }, 10);
            }
            
            dialogueBox.scrollIntoView({ behavior: 'smooth' });
        }

        function showNextDialogue() {
            const stage = stages[gameData.currentStage];
            if (gameData.currentDialogueIndex < stage.dialogues.length) {
                const dialogue = stage.dialogues[gameData.currentDialogueIndex];
                showDialogue(dialogue);
                gameData.currentDialogueIndex++;
                saveGame();
                
                document.getElementById('prev-btn').disabled = gameData.currentDialogueIndex <= 1;
                
                if (gameData.currentDialogueIndex >= stage.dialogues.length) {
                    document.getElementById('next-btn').textContent = '–í—ã–±–æ—Ä ‚Üí';
                    document.getElementById('next-btn').onclick = showChoices;
                }
            } else {
                showChoices();
            }
        }

        function showPreviousDialogue() {
            if (gameData.currentDialogueIndex > 1) {
                const dialogueContainer = document.getElementById('dialogue-container');
                dialogueContainer.removeChild(dialogueContainer.lastChild);
                gameData.currentDialogueIndex--;
                saveGame();
                
                document.getElementById('prev-btn').disabled = gameData.currentDialogueIndex <= 1;
                document.getElementById('next-btn').textContent = '–î–∞–ª–µ–µ ‚Üí';
                document.getElementById('next-btn').onclick = showNextDialogue;
                document.getElementById('choices-container').classList.add('hidden');
            }
        }

        function showChoices() {
            const stage = stages[gameData.currentStage];
            const choicesContainer = document.getElementById('choices-container');
            choicesContainer.innerHTML = '';
            
            stage.choices.forEach((choice, index) => {
                const button = document.createElement('button');
                button.className = 'choice-btn';
                button.textContent = choice.text;
                button.onclick = () => makeChoice(choice.type);
                choicesContainer.appendChild(button);
            });
            
            choicesContainer.classList.remove('hidden');
            document.getElementById('next-btn').disabled = true;
        }

        function makeChoice(choiceType) {
            const stage = stages[gameData.currentStage];
            const resultContainer = document.getElementById('result-container');
            const resultText = document.getElementById('result-text');
            
            document.getElementById('choices-container').classList.add('hidden');
            resultContainer.classList.remove('hidden');
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä
            gameData.choices[gameData.currentStage] = choiceType;
            
            if (choiceType === 'good') {
                resultText.innerHTML = `
                    <div class="dialogue-box">
                        <div class="character-name">–î–∏–º–∞ (—Å–º–µ—ë—Ç—Å—è):</div>
                        <div class="dialogue-text">¬´–£—Ä–∞! –¢—ã —Å–∞–º—ã–π –ª—É—á—à–∏–π –±—Ä–∞—Ç!¬ª</div>
                    </div>
                    <div class="dialogue-box">
                        <div class="character-name">–ú–∞–º–∞ (—É–ª—ã–±–∞–µ—Ç—Å—è):</div>
                        <div class="dialogue-text">¬´–°–ø–∞—Å–∏–±–æ, –°–∞—à–∞. –í–æ—Ç —Ç–∞–∫ –∏ –¥–æ–ª–∂–µ–Ω –ø–æ—Å—Ç—É–ø–∞—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–π –º—É–∂—á–∏–Ω–∞.¬ª</div>
                    </div>
                `;
            } else {
                gameData.lives--;
                document.getElementById('lives-count').textContent = gameData.lives;
                resultText.innerHTML = `
                    <div class="dialogue-box">
                        <div class="character-name">–î–∏–º–∞ (–ø–ª–∞—á–µ—Ç):</div>
                        <div class="dialogue-text">¬´–¢—ã –æ–±–µ—â–∞–ª‚Ä¶¬ª</div>
                    </div>
                    <div class="dialogue-box">
                        <div class="character-name">–ú–∞–º–∞ (—Å–µ—Ä–¥–∏—Ç–æ):</div>
                        <div class="dialogue-text">¬´–°–∞—à–∞, —è –Ω–∞ —Ç–µ–±—è —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–ª–∞. –û—á–µ–Ω—å –∂–∞–ª—å.¬ª</div>
                    </div>
                `;
                
                if (gameData.lives <= 0) {
                    setTimeout(() => {
                        alert('–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í—ã –ø–æ—Ç–µ—Ä—è–ª–∏ –≤—Å–µ –∂–∏–∑–Ω–∏.');
                        startNewGame();
                    }, 1000);
                    return;
                }
            }
            
            // –ü–æ–º–µ—á–∞–µ–º —ç—Ç–∞–ø –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π
            gameData.completedStages.push(gameData.currentStage);
            saveGame();
            
            resultContainer.scrollIntoView({ behavior: 'smooth' });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = showStart;
    </script>
</body>
</html>
